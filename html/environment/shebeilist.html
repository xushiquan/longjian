<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/aui.css"/>
    <style>
    	html,body{
			height: 100%;
			background: transparent;
			-webkit-touch-callout: none;
			font-family: Tahoma, Geneva, sans-serif;
			font-style: normal;
		}
		#dialog{
			background-color: #e7e7e7;
			position: absolute; margin: auto;
			left: 0; right: 0; top: 0; bottom: 0;
			width: 90%; height: 360px;
			-webkit-transition: all .1s;
			transition:all .1s;
			-webkit-transform: scale(0);
			transform:scale(0);
			opacity: 0;
		}
		#dialog.in{
			-webkit-transform: scale(1);
			transform:scale(1);
			opacity: 1;
		}
		header{
			margin: 0 10px;
			padding: 10px 0;
			text-align: center;
			font-size: 24px;
			color: #767676;
			border-bottom: 2px solid #E0E0E0;
		}
		header >span{
			margin:auto;
		}
		#blank{
			width:100%;
			height:302px;
		}
    </style>
</head>
<body>
	<div id="dialog">
		<header>
			<span>选择设备</span>
		</header>
		<div id="blank"></div>
	</div>
</body>
<script type="text/javascript" src="../../script/zepto.js"></script>
<script type="text/javascript">
	$('#dialog').addClass('in');
	$(document.body).on('touchend',function(e){
		var dialog = $("#dialog")[0];
		if(!$.contains(dialog, e.target)){
			$('#dialog').removeClass('in');
			setTimeout(function(){
				api.closeFrame();
			},200);
		}
	});
	apiready = function(){
		setTimeout("makeList()",300);
	};
	function makeList(){
		var data = api.pageParam.shebeilist;
		var UIListView = api.require('UIListView');
		UIListView.open({
		    rect: {
		        x: api.winWidth*0.05,
		        y: (api.winHeight-360)/2+58,
		        w: api.winWidth*0.9,
		        h: 302
		    },
		    data: data,
		    styles: {
		        borderColor: '#696969',
		        item: {
		            bgColor: '#FFFFFF',
		            activeBgColor: '#F5F5F5',
		            titleSize: 15.0,
		            titleColor: '#000',
		            subTitleSize: 12.0,
    				subTitleColor: '#D8D8D8'
		        }
		    },
		    fixedOn:'shebeilist'
		}, function( ret, err ){
		    if( ret ){
		    	if(ret.eventType!="show"){
					var deviceId = data[ret.index].subTitle.substring(5);
					console.log(JSON.stringify(data[ret.index]));
					api.execScript({
						name:api.pageParam.monitor,
	                    script: 'reload("'+deviceId+'");'
                    });
                    api.closeFrame();
		    	}
		    }
		});
	}
</script>
</html>
